<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Memory Match â€” Fly Express</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@600;700;800;900&display=swap" rel="stylesheet">
<style>
  :root{
    --glass: rgba(255,255,255,.06);
    --card: rgba(255,255,255,.08);
    --muted:#b8c0c9;
    --ok:#00ffaa;
    --bad:#ff4d7a;
    --title:#60e9ff;
  }
  *{box-sizing:border-box}
  body{
    margin:0; font-family:'Cairo',system-ui,sans-serif; color:#eaf1f6;
    min-height:100svh; display:flex; align-items:center; justify-content:center; padding:22px;
    background:
      radial-gradient(1100px 600px at 10% 10%, #071b2a 0%, transparent 65%),
      radial-gradient(1100px 600px at 90% 90%, #00131c 0%, transparent 65%),
      conic-gradient(from 0deg at 50% 50%, #021018, #0b2b44, #032235, #021018);
    background-size:140% 140%,140% 140%,200% 200%;
    animation: bg1 16s ease-in-out infinite, hue 32s linear infinite;
  }
  @keyframes bg1{0%,100%{background-position:10% 10%,90% 90%,0% 50%}50%{background-position:30% 20%,70% 80%,100% 50%}}
  @keyframes hue{0%{filter:hue-rotate(0)}100%{filter:hue-rotate(360deg)}}

  .frame{
    width:100%; max-width:900px; border-radius:24px; padding:22px;
    background:rgba(255,255,255,.04); border:1px solid rgba(255,255,255,.08);
    box-shadow:0 18px 50px rgba(0,0,0,.28), inset 0 0 0 1px rgba(255,255,255,.05);
  }
  h1{margin:0 0 10px; font-size:34px; font-weight:900; color:#fff; text-align:center}
  h1 .brand{color:var(--title)}
  .sub{margin:6px auto 18px; text-align:center; color:#cfe2ee}

  .stats{display:flex; gap:12px; justify-content:space-between; flex-wrap:wrap}
  .stat{
    flex:1 1 150px; background:var(--glass); border:1px solid rgba(255,255,255,.08);
    padding:12px 14px; border-radius:16px; text-align:center; box-shadow:0 10px 24px rgba(0,0,0,.25);
  }
  .stat .v{font-size:22px; font-weight:900}
  .stat .k{font-size:13px; color:var(--muted)}

  .actions{display:flex; gap:12px; justify-content:center; margin:14px 0 4px}
  .btn{
    background:linear-gradient(90deg,#00ffaa,#7cc6ff); color:#001316; font-weight:900;
    padding:10px 18px; border:none; border-radius:999px; cursor:pointer;
    box-shadow:0 10px 28px rgba(0,255,170,.25); transition:transform .1s ease; font-size:16px;
  }
  .btn.secondary{background:linear-gradient(90deg,#d3f3ff,#b4ffd0); color:#003b35}
  .btn:active{transform:translateY(1px)}

  .board{margin-top:14px; background:rgba(0,0,0,.25); border:1px solid rgba(255,255,255,.07);
    border-radius:18px; padding:16px;}
  .grid{display:grid; gap:12px; justify-items:center}
  .grid.cols4{grid-template-columns:repeat(4,1fr)}
  .grid.cols5{grid-template-columns:repeat(5,1fr)}
  .grid.cols6{grid-template-columns:repeat(6,1fr)}

  .card{
    width:100%; max-width:120px; aspect-ratio:1/1.2; border-radius:16px; position:relative;
    perspective:900px; cursor:pointer;
  }
  .face{
    position:absolute; inset:0; display:grid; place-items:center; font-size:46px; font-weight:900;
    border-radius:16px; border:1px solid rgba(255,255,255,.12);
    backface-visibility:hidden; transition: transform .4s ease;
    box-shadow:0 12px 26px rgba(0,0,0,.35);
  }
  .front{ background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(0,0,0,.35)); transform:rotateY(0deg)}
  .back{ background:linear-gradient(180deg, #5eead4, #22d3ee); color:#002; transform:rotateY(180deg)}
  .card.flipped .front{ transform:rotateY(180deg)}
  .card.flipped .back{ transform:rotateY(0deg)}
  .card.matched{ filter:saturate(1.2) drop-shadow(0 0 10px rgba(0,255,170,.35))}

  .result{margin:12px 0 8px; text-align:center; font-weight:900}
  .result.win{color:var(--ok)} .result.lose{color:var(--bad)}

  #overlay{
    position:fixed; inset:0; display:none; place-items:center; background:rgba(0,0,0,.5); backdrop-filter: blur(3px); z-index:30;
  }
  .box{
    background:rgba(10,20,28,.96); border:1px solid rgba(255,255,255,.08); border-radius:18px; padding:22px; text-align:center;
    box-shadow:0 24px 50px rgba(0,0,0,.45); width:min(520px,92vw);
  }
  .claim{display:flex; gap:10px; justify-content:center; flex-wrap:wrap; margin-top:12px}
  .wa{background:#25d366; color:#003; border:none; border-radius:999px; padding:10px 14px; font-weight:900; cursor:pointer}
  .next{background:linear-gradient(90deg,#ffd166,#ff7eb3); color:#003; border:none; border-radius:999px; padding:10px 14px; font-weight:900; cursor:pointer}
</style>
</head>
<body>

<div class="frame">
  <h1><span class="brand">Fly Express</span> â€” Memory Match</h1>
  <div class="sub">ğŸ¯ Ø®Ù„Ù‘Øµ Ø§Ù„Ø³Ø¨Ø¹ Ù…Ø±Ø§Ø­Ù„ ÙˆØ§ÙƒØ³Ø¨ ØªÙˆØµÙŠÙ„Ø© Ù…Ø¬Ø§Ù†ÙŠÙ‘Ø©!</div>

  <div class="stats">
    <div class="stat"><div class="v" id="level">1</div><div class="k">Ø§Ù„Ù…Ø³ØªÙˆÙ‰</div></div>
    <div class="stat"><div class="v" id="time">60</div><div class="k">Ø§Ù„ÙˆÙ‚Øª (Ø«)</div></div>
    <div class="stat"><div class="v" id="score">0</div><div class="k">Ø§Ù„Ù†Ù‚Ø§Ø·</div></div>
    <div class="stat"><div class="v" id="moves">0</div><div class="k">Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª</div></div>
    <div class="stat"><div class="v" id="best">0</div><div class="k">Ø£Ø¹Ù„Ù‰ Ù†ØªÙŠØ¬Ø©</div></div>
    <div class="stat" style="flex:1 1 220px"><button class="btn" id="startBtn">Ø§Ø¨Ø¯Ø£ ğŸ¯</button></div>
  </div>

  <div class="board">
    <div id="grid" class="grid cols4"></div>
    <div id="final" class="result"></div>
  </div>
  <div class="note">Ø±Ø§Ù‚Ø¨ Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠØ² Ø¨Ø³Ø±Ø¹Ø© â€” Ø®Ù„Ù‘Øµ Ø§Ù„Ø³Ø¨Ø¹ Ù…Ø±Ø§Ø­Ù„ ØªÙƒØ³Ø¨ ØªÙˆØµÙŠÙ„Ø© Ù…Ø¬Ø§Ù†ÙŠØ© ğŸš€</div>
</div>

<div id="overlay">
  <div class="box" id="overlayBox"></div>
</div>

<script>
const LEVELS = [
  {pairs:6,  time:30},
  {pairs:8,  time:30},
  {pairs:10, time:30},
  {pairs:12, time:35},
  {pairs:14, time:35},
  {pairs:16, time:35},
  {pairs:18, time:35}
];
const ADMIN_PHONE="201017908076";
const EMOJIS=["ğŸŒ¸","ğŸ’–","ğŸ§","ğŸ¦‹","ğŸ“","ğŸŒˆ","ğŸ±","â­","ğŸ‰","ğŸ€","ğŸ§¸","â˜•","ğŸ’","ğŸ¼","ğŸŒ¼","ğŸ“¦","ğŸ’","ğŸ©","ğŸ°","ğŸ«§","ğŸŒ™","ğŸª"];
const POINT_MATCH=100,POINT_WRONG=-10;

const gridEl=document.querySelector('#grid'),scoreEl=document.querySelector('#score'),movesEl=document.querySelector('#moves'),
timeEl=document.querySelector('#time'),bestEl=document.querySelector('#best'),finalEl=document.querySelector('#final'),
startBtn=document.querySelector('#startBtn'),overlay=document.querySelector('#overlay'),overlayBox=document.querySelector('#overlayBox'),levelEl=document.querySelector('#level');
let best=parseInt(localStorage.getItem('mm_best')||'0');bestEl.textContent=best;

let ctx,AC,outGain;
function audioInit(){if(ctx)return;AC=window.AudioContext||window.webkitAudioContext;if(!AC)return;ctx=new AC();outGain=ctx.createGain();outGain.gain.value=.15;outGain.connect(ctx.destination);}
function beep(f=800,d=.08,t="triangle"){if(!ctx)return;const o=ctx.createOscillator(),g=ctx.createGain();o.type=t;o.frequency.value=f;o.connect(g);g.connect(outGain);const s=ctx.currentTime;g.gain.setValueAtTime(.0001,s);g.gain.exponentialRampToValueAtTime(.6,s+.01);g.gain.exponentialRampToValueAtTime(.0001,s+d);o.start(s);o.stop(s+d+.01);}
["pointerdown","touchstart","click"].forEach(e=>addEventListener(e,audioInit,{once:true}));

let levelIndex=0,pairsCount,timeTotal,deck=[],first=null,second=null,lock=false,score=0,moves=0,timeLeft=0,timer=null,matched=0;

const shuffle=a=>a.sort(()=>Math.random()-0.5);
function setGridCols(p){gridEl.className='grid';if(p>=16)gridEl.classList.add('cols6');else if(p>=10)gridEl.classList.add('cols5');else gridEl.classList.add('cols4');}
function openOverlay(h){overlayBox.innerHTML=h;overlay.style.display='grid';}
function closeOverlay(){overlay.style.display='none';}
function applyLevel(){const L=LEVELS[levelIndex];pairsCount=L.pairs;timeTotal=L.time;setGridCols(pairsCount);levelEl.textContent=levelIndex+1;}

function showWin(){
  const isLast=levelIndex===LEVELS.length-1;
  openOverlay(isLast?`
  <h2>ğŸ‰ Ù…Ø¨Ø±ÙˆÙƒ! Ø®Ù„Ù‘ØµØª Ø§Ù„Ø³Ø¨Ø¹ Ù…Ø±Ø§Ø­Ù„!</h2>
  <p>ÙƒØ³Ø¨Øª <b>ØªÙˆØµÙŠÙ„Ø© Ù…Ø¬Ø§Ù†ÙŠØ©</b> Ù…Ù† Fly Express ğŸš€</p>
  <div class="claim">
    <button class="wa" id="waBtn">Ø§Ø·Ù„Ø¨ Ù‡Ø¯ÙŠØªÙƒ ğŸ</button>
    <button class="next" id="againBtn">Ø¥Ø¹Ø§Ø¯Ø© Ù…Ù† Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© ğŸ”</button>
  </div>
  `:`
  <h2>âœ… Ø®Ù„Ù‘ØµØª Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ${levelIndex+1}!</h2>
  <p>Ø¬Ø§Ù‡Ø² Ù„Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù„ÙŠ Ø¨Ø¹Ø¯Ù‡ØŸ</p>
  <div class="claim">
    <button class="next" id="nextBtn">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ§Ù„ÙŠ â­ï¸</button>
    <button class="wa" id="replayBtn">Ø¥Ø¹Ø§Ø¯Ø© Ù†ÙØ³ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ğŸ”„</button>
  </div>`);
  if(isLast){
    document.querySelector('#waBtn').onclick=()=>window.open(`https://wa.me/${ADMIN_PHONE}?text=${encodeURIComponent('Ù…Ø¨Ø±ÙˆÙƒ! Ø®Ù„ØµØª Ø§Ù„Ø³Ø¨Ø¹ Ù…Ø±Ø§Ø­Ù„ ÙÙŠ Ù„Ø¹Ø¨Ø© Memory Match ÙˆÙƒØ³Ø¨Øª ØªÙˆØµÙŠÙ„Ø© Ù…Ø¬Ø§Ù†ÙŠØ© ğŸ‰')}`,'_blank');
    document.querySelector('#againBtn').onclick=()=>{levelIndex=0;applyLevel();closeOverlay();startGame();};
  }else{
    document.querySelector('#nextBtn').onclick=()=>{levelIndex++;applyLevel();closeOverlay();startGame();};
    document.querySelector('#replayBtn').onclick=()=>{closeOverlay();startGame();};
  }
}
function showRetry(){
  openOverlay(`<h2>Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª â³</h2>
  <p>Ù‡ØªØ±Ø¬Ø¹ <b>Ù„Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø£ÙˆÙ„</b> ÙˆØªØ¨Ø¯Ø£ Ù…Ù† Ø¬Ø¯ÙŠØ¯.</p>
  <div class="claim"><button class="next" id="retryBtn">Ø§Ø¨Ø¯Ø£ Ù…Ù† Ø§Ù„Ø£ÙˆÙ„ ğŸ”</button></div>`);
  document.querySelector('#retryBtn').onclick=()=>{levelIndex=0;applyLevel();closeOverlay();startGame();};
}

function buildDeck(){const chosen=shuffle([...EMOJIS]).slice(0,pairsCount);deck=shuffle([...chosen,...chosen]).map((sym,i)=>({id:i,sym,matched:false}));}
function render(){gridEl.innerHTML='';deck.forEach(c=>{const el=document.createElement('div');el.className='card';el.dataset.id=c.id;el.innerHTML=`<div class="face front">?</div><div class="face back">${c.sym}</div>`;gridEl.appendChild(el);});}
function flipCard(el){
  if(lock)return;const id=+el.dataset.id,card=deck.find(c=>c.id===id);
  if(!card||card.matched||el.classList.contains('flipped'))return;
  el.classList.add('flipped');beep(700,.06,"square");
  if(!first)first={el,card};else{
    second={el,card};lock=true;moves++;movesEl.textContent=moves;
    if(first.card.sym===second.card.sym){
      first.card.matched=second.card.matched=true;first.el.classList.add('matched');second.el.classList.add('matched');
      score+=POINT_MATCH;scoreEl.textContent=score;matched++;beep(980,.09,"sine");
      [first,second]=[null,null];lock=false;if(matched===pairsCount)endGame(true);
    }else{
      score=Math.max(0,score+POINT_WRONG);scoreEl.textContent=score;
      setTimeout(()=>{first.el.classList.remove('flipped');second.el.classList.remove('flipped');[first,second]=[null,null];lock=false;},650);
    }
  }
}
function startGame(){
  score=0;moves=0;matched=0;timeLeft=timeTotal;
  scoreEl.textContent=0;movesEl.textContent=0;timeEl.textContent=timeLeft;finalEl.textContent='';
  buildDeck();render();
  gridEl.querySelectorAll('.card').forEach(el=>el.onclick=()=>flipCard(el));
  clearInterval(timer);
  timer=setInterval(()=>{timeLeft--;timeEl.textContent=timeLeft;if(timeLeft<=0)endGame(false);},1000);
}
function endGame(win){
  clearInterval(timer);
  if(win){
    best=Math.max(best,score);localStorage.setItem('mm_best',best);bestEl.textContent=best;
    finalEl.textContent=`ØªÙ…Ø§Ù…! Ø®Ù„ØµØª Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ${levelIndex+1} â€” Ù†ØªÙŠØ¬ØªÙƒ: ${score}`;
    finalEl.classList.add('win');showWin();
  }else{
    finalEl.textContent=`Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª â€” Ø±Ø¬Ø¹Ù†Ø§ Ù„Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø£ÙˆÙ„`;finalEl.classList.add('lose');showRetry();
  }
}

startBtn.onclick=()=>{applyLevel();startGame();};
applyLevel();
</script>
</body>
</html>
